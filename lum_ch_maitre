blueprint:
  name: Synchronisation des WLED avec l'éclairage de la chambre
  description: Ajuste les WLED basés sur l'état des lumières de chevet et du plafond avec sélection de couleur et d'effet.
  domain: automation
  input:
    chevet_light:
      name: Lumière de Chevet
      selector:
        entity:
          domain: light
    ceiling_light:
      name: Lumière du Plafond
      selector:
        entity:
          domain: light
    wled_light:
      name: Lumière WLED
      selector:
        entity:
          domain: light
    wled_color:
      name: Couleur WLED pour Chevet (format hex, ex., #FFA500 pour orange)
      default: "#FFFFFF"
      selector:
        text: {}
    wled_effect:
      name: Effet WLED pour Plafond
      selector:
        select:
          options:
            - "Blink"
            - "Breathe"
            - "Color Wipe"
            - "Sweep Random"
            - "Static"
            - "Rainbow"
            - "Rainbow Cycle"
    segment_id_chevet:
      name: Segment ID pour Chevet
      default: "1,3"
      selector:
        text: {}
    segment_id_ceiling:
      name: Segment ID pour Plafond
      default: "0"
      selector:
        text: {}

trigger:
  - platform: state
    entity_id: !input 'chevet_light'
  - platform: state
    entity_id: !input 'ceiling_light'

action:
  - choose:
      - conditions:
          - condition: state
            entity_id: !input 'ceiling_light'
            state: 'on'
        sequence:
          - service: light.turn_on
            target:
              entity_id: !input 'wled_light'
            data:
              effect: !input 'wled_effect'
              brightness_pct: 100
      - conditions:
          - condition: state
            entity_id: !input 'chevet_light'
            state: 'on'
          - condition: state
            entity_id: !input 'ceiling_light'
            state: 'off'
        sequence:
          - service: light.turn_on
            target:
              entity_id: !input 'wled_light'
            data:
              color_name: !input 'wled_color'
              brightness_pct: 100
mode: restart